import subprocess
import tkinter as tk
from tkinter import simpledialog
import os

def open_cmd_and_type():
    # Create a root window but keep it hidden
    root = tk.Tk()
    root.withdraw()

    # Ask for input
    text = simpledialog.askstring("Input", "Enter the text you want to type in the command prompt:")

    if text:
        try:
            # Use 'powershell' instead of 'cmd' for better Windows 11 compatibility
            command = f'powershell.exe -Command "Start-Process powershell -ArgumentList \'-NoExit\',\'-Command\',\'{text}\'"'
            subprocess.run(command, shell=True, check=True)
            print("Command executed successfully!")
        except subprocess.CalledProcessError as e:
            print(f"An error occurred: {e}")
    else:
        print("No text entered.")

if __name__ == "__main__":
    open_cmd_and_type()
